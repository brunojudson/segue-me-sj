<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" lang="pt-BR" xml:lang="pt-BR">

<ui:define name="title">Trabalhadores - Sistema Segue-me</ui:define>

<ui:composition template="/templates/template.xhtml">
	<ui:define name="content">
		<div class="content-container">
			<!-- Cabeçalho moderno da página -->
			<div class="page-header">
				<div class="page-header-content">
					<div class="page-title-section">
						<h1 class="page-title">
							<i class="pi pi-users page-icon"></i> <span class="title-text">Trabalhadores</span>
						</h1>
						<p class="page-subtitle">Gerencie os trabalhadores do sistema
						</p>
					</div>
					<div class="header-actions">
						<p:button value="Novo Trabalhador"
							outcome="/pages/trabalhador/cadastro.xhtml" icon="pi pi-plus"
							styleClass="action-button-primary"
							title="Cadastrar novo trabalhador" />
					</div>
				</div>
			</div>

			<h:form id="listForm" prependId="false">
				<p:messages id="messages" showDetail="true" closable="true" />

				<!-- Tabela moderna de trabalhadores -->
				<p:dataTable id="trabalhadoresTable" var="trabalhador"
					value="#{trabalhadorController.trabalhadores}"
					emptyMessage="Nenhum trabalhador encontrado"
					styleClass="modern-datatable datatable-animation" paginator="true"
					rows="20" paginatorPosition="bottom" stripeRows="true"
					paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
					currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords} registros"
					rowsPerPageTemplate="20,50,100"
					filterable="true"
					filterDelay="300"
					widgetVar="trabalhadoresTableWidget">

					<p:column headerText="ID" sortBy="#{trabalhador.id}"
						styleClass="text-center" width="5%" responsivePriority="6">
						<div class="id-badge">#{trabalhador.id}</div>
					</p:column>

					<p:column headerText="Pessoa" sortBy="#{trabalhador.pessoa.nome}"
						filterBy="#{trabalhador.pessoa.nome}" filterMatchMode="contains"
						styleClass="text-left" width="25%">
						<div class="worker-info">
							<div class="worker-avatar">
								<i class="pi pi-user"></i>
							</div>
							<h:outputText value="#{trabalhador.pessoa.nome}"
								styleClass="worker-name" />
						</div>
					</p:column>
					<p:column headerText="Equipe" sortBy="#{trabalhador.equipe.nome}"
						filterBy="#{trabalhador.equipe.nome}" filterMatchMode="contains"
						styleClass="text-left" width="13%" responsivePriority="2">
						<span class="team-badge"> <i class="pi pi-users"></i>
							#{trabalhador.equipe.nome}
						</span>
					</p:column>

					<p:column headerText="Encontro"
						sortBy="#{trabalhador.encontro.nome}"
						filterBy="#{trabalhador.encontro.nome}" filterMatchMode="contains"
						styleClass="text-left" width="15%" responsivePriority="4">
						<h:outputText value="#{trabalhador.encontro.nome}" />
					</p:column>

					<p:column headerText="Coordenador" styleClass="text-center"
						width="8%" responsivePriority="6">
						<div class="status-indicator">
							<i
								class="pi #{trabalhador.ehCoordenador ? 'pi-check-circle status-active2' : 'pi-minus-circle status-inactive2'}"></i>
						</div>
					</p:column>

					<p:column headerText="Idade" styleClass="text-center" width="5%"
						responsivePriority="5">
						<div class="age-info">
							<h:outputText id="idade" value="#{trabalhador.idade}"
								rendered="#{not empty trabalhador.idade}" />
							<h:outputText value="-" styleClass="empty-value"
								rendered="#{empty trabalhador.idade}" />
							<p:tooltip for="idade" value="Idade quando trabalhou no encontro" />
						</div>
					</p:column>

					<p:column headerText="Foi Encontrista" styleClass="text-center"
						width="8%" responsivePriority="6">
						<div class="status-indicator">
							<i
								class="pi #{trabalhador.foiEncontrista ? 'pi-check-circle status-active2' : 'pi-times-circle status-inactive2'}"></i>
						</div>
					</p:column>

					<p:column headerText="Status" styleClass="text-center" width="10%"
						responsivePriority="3">
						<span
							class="status-badge #{trabalhador.ativo ? 'ativo' : 'inativo'}">
							<i
							class="pi #{trabalhador.ativo ? 'pi-check-circle' : 'pi-times-circle'}"></i>
							#{trabalhador.ativo ? 'Ativo' : 'Inativo'}
						</span>
					</p:column>

					<p:column headerText="Ações" styleClass="text-center" width="11%">
						<div class="table-action-buttons">
							<p:commandButton icon="pi pi-eye" title="Visualizar"
								action="#{trabalhadorController.visualizar(trabalhador)}"
								styleClass="action-button-secondary-table action-btn" />

							<p:commandButton icon="pi pi-pencil" title="Editar"
								action="#{trabalhadorController.editar(trabalhador)}"
								styleClass="action-button-warn-table action-btn" />

							<p:commandButton icon="pi pi-trash" title="Excluir"
								action="#{trabalhadorController.prepararExclusao(trabalhador)}"
								styleClass="action-button-danger-table action-btn"
								update=":confirmDialog" oncomplete="PF('confirmDialog').show()" />
						</div>
					</p:column>
				</p:dataTable>

				<!-- Diálogo de confirmação -->
				<p:confirmDialog id="confirmDialog" widgetVar="confirmDialog"
					header="Confirmar Exclusão" styleClass="modern-dialog"
					message="Tem certeza que deseja excluir este trabalhador?"
					closeOnEscape="true" width="450" height="200">
					<p:commandButton value="Sim, excluir"
						action="#{trabalhadorController.excluir}"
						oncomplete="PF('confirmDialog').hide()"
						update="trabalhadoresTable messages" styleClass="ui-button-danger"
						icon="pi pi-trash" />
					<p:commandButton value="Cancelar"
						onclick="PF('confirmDialog').hide()" type="button"
						styleClass="ui-button-secondary" icon="pi pi-times" />
				</p:confirmDialog>
			</h:form>
		</div>

		<style>
/* Badges de status modernos */
.status-badge {
	display: inline-flex;
	align-items: center;
	gap: 0.25rem;
	padding: 0.375rem 0.75rem;
	border-radius: 20px;
	font-size: 0.75rem;
	font-weight: 600;
	text-transform: uppercase;
	letter-spacing: 0.5px;
}

.status-badge.ativo {
	background-color: #e8f5e8;
	color: #2e7d32;
	border: 1px solid #c8e6c9;
}

.status-badge.inativo {
	background-color: #ffebee;
	color: #c62828;
	border: 1px solid #ffcdd2;
}
/* Estilos específicos para trabalhadores */
.worker-info {
	display: flex;
	align-items: center;
	gap: 0.75rem;
}

.worker-avatar {
	width: 32px;
	height: 32px;
	background: linear-gradient(135deg, #3b82f6, #1d4ed8);
	border-radius: 50%;
	display: flex;
	align-items: center;
	justify-content: center;
	color: white;
	flex-shrink: 0;
}

.worker-name {
	font-weight: 600;
	color: #333;
}

.team-badge {
	display: inline-block;
	white-space: nowrap;
	max-width: 140px;
	overflow: hidden;
	text-overflow: ellipsis;
	vertical-align: middle;
	align-items: center;
	gap: 0.5rem;
	padding: 0.25rem 0.75rem;
	border-radius: 12px;
	font-size: 0.875rem;
	font-weight: 500;
	background: linear-gradient(135deg, #10b981, #059669);
	color: white;
}

.age-info {
	display: flex;
	align-items: center;
	justify-content: center;
	font-weight: 600;
	color: #374151;
}
</style>
	</ui:define>
</ui:composition>

</html>
